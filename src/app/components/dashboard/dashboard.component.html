<section
  class="flex flex-col items-start justify-between gap-4 w-full px-6 py-10"
>
  <p class="text-2xl font-semibold font-rubik text-nowrap">Dashboard</p>
  @if(loadingState$ | async) {
  <app-dashboard-skeleton class="w-full" />
  }@else {
  <div class="grid grid-cols-1 xl:grid-cols-2 gap-10 w-full">
    <div
      class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-10 w-full xl:col-span-2"
    >
      <app-summary
        class="grow"
        title="Products Sold"
        [count]="(productsSold$ | async) ?? 0"
        [increase]="(soldIncrease$ | async) ?? 0"
      />
      <app-summary
        class="grow"
        title="Revenue"
        [count]="(revenue$ | async) ?? 0"
        [increase]="(revenueIncrease$ | async) ?? 0"
      />
      <app-summary
        class="grow"
        title="Total Customers"
        [count]="(totalCustomers$ | async) ?? 0"
        [increase]="(totalCustomersIncrease$ | async) ?? 0"
      />
      <app-summary
        class="grow"
        title="Total Quantity"
        [count]="(totalQuantity$ | async) ?? 0"
        [decrease]="(totalQuantityDecrease$ | async) ?? 0"
      />
    </div>
    <app-sales-chart />
    <div class="bg-edit-input-color p-6 rounded-3xl h-96 shadow-lg">
      <h2 class="text-xl font-medium">Stock Report</h2>
      <div class="flex flex-col gap-6 pt-4 w-full h-full overflow-scroll mb-2">
        @for(item of (stockReport$ | async); track item.product.id){

        <app-stock-item
          [productName]="item.product.name"
          [quantity]="item.product.quantity"
          [remaining]="item.remaining"
          [remainingPercantage]="item.remainingPercentage"
        />
        }
      </div>
    </div>
    <div class="bg-edit-input-color grow p-6 rounded-3xl shadow-lg h-96">
      <h2 class="text-xl font-medium">Recent Orders</h2>
      <div class="flex flex-col gap-6 pt-4 h-full overflow-scroll">
        @for(order of (orders$ | async); track order?.orderItem?.id){
        <app-dashboard-orders
          [customerName]="order.orderItem.customerName"
          [customerAvatar]="order.orderItem.customerAvatar"
          [orderDate]="order.orderItem.date"
          [orderPrice]="order.productPrice"
          [orderName]="order.productName"
          [orderCurrency]="order.productCurrency"
          [userCurrency]="(userCurrency$ | async) ?? 'ZAR'"
          [conversionData]="conversionData$ | async"
        />
        }
      </div>
    </div>
    <div class="bg-edit-input-color grow p-6 rounded-3xl h-96 shadow-lg">
      <h2 class="text-xl font-medium">Top Products</h2>
      <div class="h-full grid grid-cols-2 sm:grid-cols-3 gap-5 pt-4 pb-6">
        @for(product of (topProducts$ | async); track product.product.id){
        <img
          *ngIf="product.product.imageUrl"
          [src]="product.product.imageUrl"
          [alt]="product.product.name"
          class="min-w-32 min-h-32 object-cover rounded-lg place-self-stretch"
        />
        <img
          *ngIf="!product.product.imageUrl"
          [src]="'../../../assets/images/placeholderImage.webp'"
          [alt]="product.product.name"
          class="min-w-32 min-h-32 object-cover rounded-lg place-self-stretch"
        />
        }
      </div>
    </div>
  </div>
  }
</section>
